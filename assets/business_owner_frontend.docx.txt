# אפיון אפליקציית קארדז - ממשק בעלי עסקים
## מסמך אפיון אחיד ומעודכן


**תאריך עדכון:** 2024-12-19  
**גרסה:** 1.0 Final  
**פלטפורמה:** React Web PWA


---


## כללי - מטרה ויעדים


מטרת הממשק לתת מידע ואפשרויות פונקציות הכרטיסייה. 


ממשק זה מתחלק לממשק ניהול וממשק המפתח. (הגישה לממשק המפתח תהיה מתוך ממשק הניהול עם סמל של גלגל שיניים ומאובטח ברמה הגבוהה ביותר או ממשק וובי אם זה לא מסבך את האפליקציה)


לממשק ניהול בקאנד אין אפליקציה נפרד- הכניסה מתוך מסך ראשי תפריט המבורגר פריט "כניסת עסקים"


נדרשת רמת אבטחה לכניסה זו - רצוי דרך אימייל וסיסמה או כל רמה אחרת גבוהה.


ממשק זה תהיה כניסה לממשק המפתח שיפותח בשלב הבא.


---


## מחסנית טכנולוגית ופלטפורמה


### טכנולוגיות עיקריות:
- **React Web** - ממשק רספונסיבי מלא
- **TypeScript** - type safety וקוד משותף
- **Vite** - build tool מהיר ומודרני
- **Supabase** - מסד נתונים וAPI (קיים)
- **PWA (Progressive Web App)** - פלטפורמת הפצה


### פלטפורמת הפצה - PWA:


**מה זה PWA:**
- אפליקציית ווב שמתנהגת כמו אפליקציה נייטיבית
- "התקנה" דרך הדפדפן לשולחן העבודה/מסך הבית
- עובדת כמו אפליקציה רגילה (אייקון, חלון נפרד)
- עדכונים אוטומטיים ללא מעורבות המשתמש


**יתרונות PWA עבור בעלי עסקים:**
✓ התקנה קלה - "Add to Home Screen" ללא חנויות אפליקציות
✓ עובדת על כל פלטפורמה - Windows, Mac, iPad, Android tablets
✓ עדכונים מיידיים - אין צורך באישורים או הורדות
✓ נראית מקצועית - אייקון בשולחן העבודה, פותחת כאפליקציה
✓ אין תלות בדפדפן - חלון נפרד ללא כתובת URL


**תהליך התקנה:**
1. בעל עסק נכנס לכתובת ווב מהטאבלט/מחשב
2. הדפדפן מציע אוטומטית "התקן אפליקציה"
3. לחיצה אחת - האפליקציה מותקנת
4. אייקון נוצר בשולחן העבודה/מסך הבית
5. שימוש רגיל כמו אפליקציה נייטיבית


---


## מבנה ארכיטקטוני


### הפרדת ממשקים:
- **ממשק לקוחות**: React Native (מובייל בלבד) - read-only + ברקוד
- **ממשק בעלי עסקים**: React Web PWA - ניהול מלא, רספונסיבי


### עיצוב רספונסיבי מלא:


**טאבלט/iPad (1024×768 ומעלה):**
הממשק לטבלט יבנה באופן של תפריט נפתח בציר Y לאורך המסך (אפשרות ידידותית לפתוח ולהסתיר התפריט) כאשר המעבר בין פרטי התפריט יתבצע לאורך הציר. בעת מעבר פריט תפריט הוא יואר/יסומן על גבי ציר התפריט והתוכן כולל הכותרת יתחלפו בהתאם לפריט הנבחר.


- תפריט צד קבוע (Sidebar Navigation)
- תוכן ראשי במרכז
- פריט תפריט מואר/מסומן
- תוכן מתחלף ללא טעינה מחדש


**מובייל/סלולרי (פחות מ-1024px):**
הממשק לסלולר יתבצע עם תפריט המבורגר שיפתח ממסך הכניסה לממשק והצגת כל בחירת פריט בדף נפרד למילוי ושינוי עם אפשרות לחזרה לתפריט ראשי בכל מסך. כל פריט תפריט יהיה במסך גלילה נפרד כאמור.


- תפריט המבורגר
- דפים נפרדים לכל פונקציה
- אפשרות חזרה לתפריט ראשי מכל מסך
- גלילה אנכית לכל דף


**דסקטופ רחב:**
- תפריט צד מורחב עם תיאורים
- תוכן רחב עם עמודות נוספות
- ניצול מקסימלי של שטח המסך


בכל אחד מהדפים בסלולר ובתצוגת האייפד המאוזנת ירשם שם העסק והלוגו בצד ימין שיקראו דינמית מתוך סופרבייס ולוגו קבוע (לא דינמי) של CARDZ.


---


## מצבי תצוגה ועיצוב


### Dark/Bright Mode:
במסך הכניסה - אפשרות להחלפת MODE כאשר ברירת המחדל היא DARK MODE (גם התפריט וגם תוכן הדף) ואפשרות ל-BRIGHT MODE כאשר בוחרים בו פרטי התפריט נשארים בדארק מוד והתוכן בהיר.


- **Dark Mode** - ברירת מחדל (תפריט + תוכן כהים)
- **Bright Mode** - תפריט כהה + תוכן בהיר
- מתג מעבר במסך הכניסה
- שמירת העדפת המשתמש


### ריבוי שפות + RTL:
בורר שפות שיתרגם את כל הטקסטים כולל הכפתורים והתכנים לאנגלית, צרפתית, ספרדית וערבית כולל הפיכת כיוון טבלאות ותצוגת ממשק בהתאם לכיוון קריאת השפה.


- **עברית** (ברירת מחדל) - RTL
- **אנגלית** - LTR
- **צרפתית** - LTR  
- **ספרדית** - LTR
- **ערבית** - RTL
- הפיכת כיוון טבלאות וממשק בהתאם לשפה
- תרגום מלא של כל הטקסטים והכפתורים


---


## מערכת הזדהות ואבטחה


### שינויים במערכת הכניסה:
- **במקום**: מספר טלפון (כמו בממשק לקוחות)
- **חדש**: אימייל + סיסמה לבעלי עסקים
- **רמת אבטחה גבוהה** כפי שנדרש במסמך האפיון
- **Multi-tenant** - הפרדה מוחלטת בין עסקים


### רמות הרשאה:
1. **עובד** - פעולות ניקוב רגילות
2. **מנהל/משמרת** - כל הפעולות + פעולות רגישות
3. **בעל עסק** - שליטה מלאה + הגדרות


### אבטחת נתונים:
- Row Level Security (RLS) מחמיר יותר
- כל עסק רואה רק את הנתונים שלו
- הרשאות ברמת פונקציה (פוש, ביטול ניקוב, יבוא/יצוא)


---


## מבנה התפריט הראשי


### 9 פריטי תפריט עיקריים:


**1. תפעול ניקובים**
- מסך ראשי עם טבלת לקוחות
- סריקת ברקוד, הוספת לקוח, חיפוש וסינון
- פעולות: ניקוב, עריכה, מחיקה לכל לקוח


**2. פרסום**
- הודעות פוש (ידניות ואוטומטיות)
- פופאפים (כניסה ואחרי ניקוב)
- הגרלות עם ניהול זוכים
- שוברים והטבות (עד 10 סוגים)
- חבר מביא חבר


**3. לוג/תיעוד פעולות**
- היסטוריה מלאה של כל פעולות העסק והלקוחות
- חיפוש וסינון לפי פרמטרים שונים
- ייצוא נתונים


**4. דשבורד ניהולי**
- סטטיסטיקות וגרפים
- ניתוח לקוחות ותדירות ביקורים
- חישובי כדאיות כלכלית
- דוחות בחתכי זמן


**5. ניהול תוכניות וחיובים**
- מסלולי תשלום
- מעקב אחר מכסות פוש
- רכישת חבילות נוספות


**6. הגדרות** (תת-תפריט):
- **הגדרות העסק**: פרטים, לוגו, צבעי ברנד, אנשי קשר
- **הגדרות כרטיסייה**: מספר ניקובים, אייקונים, הנחות תשלום מראש
- **הגדרות מערכת**: גיבויים, יבוא/יצוא, הרשאות משתמשים


**7. מדיניות פרטיות ותנאים משפטיים**
- מסמכים משפטיים על תנאי ההתקשרות
- מדיניות פרטיות של השירות
- תנאי שימוש באפליקציה
- הסכמי רישוי ותשלום


**8. צור קשר**
- פנייה לתמיכה
- AI צ'אטבוט לעזרה טכנית (תכנון עתידי)


**9. עזרה**
- מדריכים לשימוש
- שאלות נפוצות
- תמיכה טכנית

**תשתית סוכן AI (תכנון עתידי):**
- חלונית שיחה עם סוכן AI
- חיבור MCP לנתוני חיוב של הלקוח
- חיבור לתנאי המסלולים
- בעיות נפוצות והדרכה בשימוש באפליקציה
- דשבורד של העסק
- יכולת ייעוץ והפקת דוחות חיוב לפי דרישה
- תשתית אבטחה: סיסמה ווידוא טלפוני למידע הקשור לעסק
- הסבר איך הסוכן יכול לעזור

**יצירת קשר:**
- אימייל: yula@yuladigital.com
- פנייה לתמיכה
- שליחת בקשות


---


## סביבת פיתוח ואינטגרציה


### מבנה Monorepo:
```
cards_project/
├── apps/
│   ├── mobile/              # React Native (ממשק לקוחות - קיים)
│   ├── web-admin/           # React Web (ממשק בעלי עסקים - חדש) 
│   └── landing/             # דף נחיתה (אופציונלי)
├── packages/
│   ├── shared-types/        # TypeScript interfaces
│   ├── shared-utils/        # פונקציות משותפות
│   ├── supabase-client/     # API layer משותף
│   └── design-system/       # UI components משותפים
├── tools/
│   ├── build-scripts/       # סקריפטים לבנייה
│   └── deployment/          # סקריפטי פריסה
└── environments/            # הגדרות סביבות
    ├── dev/
    ├── staging/
    └── production/
```


### כלי ניהול Monorepo:
**Yarn Workspaces** - ניהול dependencies משותף ובuild מהיר עם caching


### סביבות פיתוח:


**Development (Local):**
- **Web Admin**: `yarn web:dev` - Vite dev server
- **Shared packages**: הוט reload אוטומטי
- **Database**: Supabase local instance או staging


**Staging (Testing):**
- **Web Admin**: Vercel/Netlify staging URL - `staging.cardzapp.com`
- **Database**: Supabase staging environment
- **משתמשים**: עסקים בטא/טסט


**Production:**
- **Web Admin**: PWA ב-production domain - `admin.cardzapp.com`
- **Database**: Supabase production
- **משתמשים**: לקוחות אמיתיים


### תהליך CI/CD:
```
# פיתוח
on: push to develop
  → Build web (staging)
  → Deploy to staging environments
  → Run automated tests


# שחרור
on: push to main
  → Build web PWA (production) 
  → Deploy to production
  → Create release tags
```


### ניהול גרסאות:
- **Semantic Versioning** - v1.2.3
- **Web PWA**: עדכונים מיידיים (מהיר)
- **תאימות לאחור** עם Supabase API


---


## אינטגרציה עם מערכת קיימת


### BusinessContext מותאם:
- הרחבה לתמיכה בריבוי עסקים
- הפרדת הרשאות לפי משתמש מחובר
- שיתוף טיפוסים עם React Native


### Supabase Integration:
- אותם טבלאות ומבנה DB
- RLS (Row Level Security) מחמיר יותר לממשק המנהל
- Real-time updates לשינויים בזמן אמת
- אותו API ופונקציות


### קוד משותף:
- TypeScript interfaces וטיפוסים
- פונקציות עזר (utils)
- Supabase client ופונקציות API
- קבועים ו-enums


---


## מסך תפעול ניקובים - פירוט מלא


### כפתורי פעולה ראשיים:
1. **כפתור מצלמה**: לפתיחת סריקת ברקוד לניקוב/בדיקת (לניקוב אוטומטי)
2. **ניקוב NFC**: מתבצע אוטומטית ברקע ללא כפתור
3. **כפתור הוספת לקוח [+]**: פותח טופס הצטרפות מלא עם כל השדות (שם, טלפון, מוצר, יום הולדת, תשלום, הערות)
4. **כפתור "לוג פעילויות לקוחות"**: פותח היסטוריית כל פעולות הלקוח (במסך נפרד/מודאל)
5. **שדה חיפוש**: מאפשר סינון לפי שם לקוח, מספר טלפון, מוצר, תשלום, סטטוס, פעולה אחרונה


### טבלת כרטיסיות לקוחות:


**שדות ליישות שמרכיבים את הכרטיסייה:**
- מספר כרטיסייה (מחושב עי סופרבייס שכולל מספר העסק, מס טלפון, מספר מוצר)
- שם לקוח
- מס טלפון 
- ת. יום הולדת
- סוג מוצר כרטיסייה (מצויין בלוגיקת מספר הכרטיסייה)
- מספר ניקובים 
- מס ניקובים להשלמה
- סטטוס תשלום (שולם מראש או ריק)
- ת.פעולה אחרונה
- הערות וCRM


**עמודות (מימין לשמאל):**
- שם לקוח
- מספר לקוח
- טלפון
- מוצר
- ניקובים (X/XX + שורת אייקונים חזותיים)
- סטטוס/פעולה אחרונה
- תשלום מראש
- ת. פעולה אחרונה
- תוקף (בהתאם לבחירת העסק בהגדרות)


**שורת פעולות (אייקונים - מסופקים ע"י המפתח):**
1. **מכשיר ניקוב**: פותח פופאפ כרטיסיית הלקוח לביצוע פעולות
2. **עריכה**: פותח מסך עריכת לקוח עם השדות הבאים:
   - מספר לקוח (לא לעריכה - רק לידיעה)
   - שם לקוח ✓
   - מספר טלפון ✓
   - יום הולדת (אופציונלי) ✓
   - סוג מוצר ✓
   - מספר ניקובים (ניקובים חלקי מסך ניקובים אפשריים בכרטיסייה) ✓
   - סטטוס תשלום (שולם מראש או ריק) ✓
   - הערות וCRM ✓
3. **מחיקה**: פותח חלונית אישור למחיקה (זמנית כלא פעיל או סופית לפי בקשה)


### פופאפ/מודאל כרטיס ניקוב:
- מציג את כרטיסיית הלקוח כפי שהיא מעוצבת בממשק הלקוח
- תצוגה גרפית מלאה בטלפון וטאבלט (מאוזן)
- תצוגת הכרטיסיה: בהירה כפי שהיא מופיעה בפרונטאנד


**5 כפתורי פעולה בתחתית:**
1. **ניקוב** — מוסיף ניקוב יחיד
2. **ניקוב מרובה** — פותח שדה להזנת מספר ניקובים
3. **חידוש כרטיסיה** — מאפס ניקובים, מתחיל כרטיסיה חדשה
4. **ביטול ניקוב** — מאפשר למחוק כל ניקוב, דורש סיסמת מנהל
5. **כפתור סגירה (X)** או "חזור" — מחזיר למסך הראשי


### פונקציונליות ניקוב אוטומטי/חצי אוטומטי:


**סוגי ניקוב:**
- **ברקוד**: לחיצה על כפתור ניקוב ברקוד → פתיחת מצלמה → ברגע סריקה → ניקוב אוטומטי + הודעה "ללקוח [שם ומשפחה] בוצע ניקוב אוטומטי"
- **NFC**: הלקוח מצמיד את הסלולרי למשטח NFC → זיהוי אוטומטי → ניקוב + הודעה זהה (עם המילה NFC במקום ברקוד)

**הודעות ללקוח במקביל:**
- **ברקוד**: פופאפ "התבצע ניקוב ברקוד אוטומטי בבית העסק [שם בית העסק], תודה"
- **NFC**: פופאפ "התבצע ניקוב NFC אוטומטי בבית העסק [שם בית העסק], תודה"

**מצבי פעולה (בהגדרות כרטיסייה):**
- **אוטומטי מלא**: ברקוד/NFC נזהה → ניקוב מיידי + פופאפ תודה
- **חצי אוטומטי**: ברקוד/NFC נזהה → הקפצה אוטומטית של חלונית כרטיסיית הלקוח להשלמה ידנית

**טיפול בשוברים:**
אם יש ללקוח שובר - תופיע הודעה לפני ניקוב: "יש לך שובר, האם לממש?" (החלטה בידי הלקוח, לא אוטומטי)

**תיעוד לוגים מלא:**
כל פעולה נרשמת בלוג הניהול האחורי ובכרטיסיית הלקוח ב"היסטוריית פעילות":
- ניקוב ברקוד/NFC/ידני
- חידוש כרטיסייה  
- מימוש הטבה מסוג ניקוב חינם אחרון
- מימוש הטבה מסוג חבר מביא חבר
- ביטול ניקוב
- שינוי פרטים לקוח


---


## פרסום - מרכז קמפיינים


### מבנה ותצוגה:
- **טאבלט**: טאבים נפרדים לכל סוג קמפיין
- **מובייל**: כל הפיצ'רים בגלילה אחת עם כותרות ברורות


### 1. הודעות פוש:


**פוש ידני:**
- כותרת הודעה (חובה)
- גוף הודעה (חובה)
- בחירת קהל: כל הלקוחות/בחירה ידנית/פילוח מתקדם
- תזמון: מיידי/מתוזמן
- בחירת שפה
- אפשרות הוספת תמונה


**פושים אוטומטיים:**
1. **פוש לפי תזמון ספציפי**: שדה הודעה + תאריך/שעה + הפעל/השבת
2. **פוש ללקוחות שלא ביקרו**: הודעה + ימים מביקור + צ'קבוקס שובר
3. **פוש ימי הולדת**: הודעה + צ'קבוקס הפעלה + צ'קבוקס שובר
4. **פוש השלמת כרטיסיה**: הודעה + ניקובים להשלמה + תנאים


### 2. פופאפים:
- כותרת/כפתור קריאה לפעולה
- גוף הפופאפ/מבצע  
- הגדרת "X" לסגירת הפופאפ
- השהייה (זמן עד להצגה בשניות)
- מספר הופעות פר לקוח (ברירת מחדל: לא מוגבל / עד להשבתה)
- אפשרות "הצג עד הפסקה" (צ'קבוקס)
- מיקום הקפצה: כניסה לכרטיסייה / אחרי ניקוב / אחרי זיהוי טלפון
- בחירת קהל יעד
- העלאת תמונה/אייקון/עיצוב (עם הוראות מידות התמונה)
- "שמור והפעל" + פופאפ אישור כפול
- לוג: כל הופעה/הצגה נרשמת בלוג (כולל לקוח, זמן, סטטוס)


### 3. הגרלות:
- שם הגרלה
- בחירת מועדי הגרלה: שבועי/חודשי/רבעוני
- בחירת סוג הטבה/שובר (מתוך 10 הסוגים של העסק)
- ההטבה המוגרלת (ניקובים/סכום/מוצר/הנחה וכל דבר שיוגדר בואוצ'ר)
- מועד תוקף ניצול המתנה המוגרלת (בחודשים)
- תיאור (כולל תנאים משפטיים/תקנון)
- קהל יעד/אירוע השתתפות (כל הלקוחות שאישרו פוש / פילוח)
- תנאי ההגרלה
- **כפתור ביצוע הגרלה רנדומלית** בין הלקוחות והצגת התוצאה לזוכה עם ואוצ'ר
- אפשרות לשלוח הודעת זכייה אוטומטית בפוש ללקוח (סימון בצ'ק בוקס)
- אפשרות לשלוח/להטמיע שובר זכייה לתוך **"תיבת דואר נכנס"** (בלחיצה על אייקון מעטפה הקיים בממשק הכרטיסייה)
- "צור והפעל" / "השבת" (ביטול/עצירה) + פופאפ אישור כפול
- לוג: תיעוד הזוכה בלוגים + כל הפעלה/עצירה/שליחת הודעת זכייה מתועדת


### 4. שוברים/הטבות:
- שם השובר (עד 10 סוגים לעסק)
- סוג שובר
- ערך/הטבה
- קהל יעד
- תוקף
- סוג הפעלה: אוטומטי/ידני


### 5. חבר מביא חבר:
- אפשרות הפעלה/ביטול (בהגדרות העסק)
- סוג שובר מתנה למזמין ולמוזמן
- לוג: מעקב מלא על הפעלת התכונה/מימוש אצל שני הצדדים
- שליחת שובר אוטומטית לאחר השלמת תהליך למוזמן ומנגנון אוטומציה להנפקת שובר למזמין בעת מימוש השובר של המוזמן


---


## דשבורד ניהולי וסטטיסטיקות


### חלונית בחירת חתך זמן:
- מתחילת התוכנית/מתחילת החודש
- בחירה אישית עם לוח שנה (מתאריך עד תאריך)


**נתונים מרכזיים:**
- סה"כ מספר לקוחות חדשים (עם טבלת עמודות לפי חודשים)
- מתוכם הצטרפות מרחוק (רישום עצמי)
- מתוכם "חבר מביא חבר"
- מתוכם הרשמה בבית העסק
- מספר לקוחות שהפעילו "חבר מביא חבר"
- מספר כרטיסיות
- מספר מימוש הטבות
- מספר ניקובים
- מספר לקוחות מנקבים בתדירות יומית/שבועי/חודשית
- מספר לקוחות שלא ביקרו בעסק חודש/חודשיים/מעל שלושה חודשים (לחצן של הפקת רשימה שמית + טלפון)
- לקוחות שצפו בכרטיסייה
- זמן ממוצע בשניות של שהייה בכניסה לכרטיסייה
- זמן ממוצע בשניות של שהייה בכרטיסייה עצמה
- לקוחות שיצרו קשר מהאפליקציה
- לקוחות שקיבלו הודעת פוש
- לקוחות שצפו בהודעת פוש
- לקוחות שלא קיבלו הודעות פוש
- **מצב כמות שליחת הודעות פוש מול מכסת החבילה** - עם כפתור **"רכוש חבילה"**
- מספר שוברי הטבה שהונפקו
- מספר שוברי הטבה שנוצלו
- מספר שוברי הטבה שלא נוצלו
- מספר שוברי הטבה לפני תפוגה (חודש או פחות)
- רשימת זוכי ההגרלות


**חישובי כדאיות כלכלית:**
שדות להכנסת נתונים לחישוב:
- ערך ניקוב
- ערך הטבה  
- ערך שובר

**מדדי רווחיות:**
- אחוז ההשקעה בתוכנית: (ערכי הטבה + שוברים) חלקי ערכי הניקוב
- רווחיות תוכנית: תוספת הניקובים לתקופה שנבחרה חלקי (ערכי הטבה + שוברים) פחות אחד (להצגה באחוזים)


**אפשרות רכישת חבילות נוספות:**
- רכישת חבילות של 1000 פושים בנפרד לפי מסלול התוכנית
- לאחר ניצול הפושים בחינם


---


## הגדרות מפורטות


### הגדרות העסק:


**שדות עיקריים:**
- שם העסק (ניתן לעריכה)
- שם משפטי אם שונה
- כתובת אימייל לקבלת הודעות/חשבוניות
- מספר ח.פ או ע.מ
- סוג/תחום עסק (תפריט נפתח - מסעדה/בית קפה/טיפול ציפורניים/קוסמטיקה ויופי/כושר/עיסויים/שטיפת רכבים/פרחים/מתנות/מזון מהיר/מיצים ושייקים/גלידות/מאפים/פיצרייה/חיות/מספרה/הסרת שיער/מוסך/בגדים/נעליים/תכשיטים ואקססוריס/אופטיקה ומשקפיים/סטודיו חוגים/משחקים וצעצועים/מורה פרטי/נהיגה/צילום ופיתוח/אחר)
- כתובת מלאה (רחוב, מספר, עיר, מיקוד)
- טלפון עסקי ראשי
- מזהה עסק (business_code, הקצאה אוטומטית 1-99000)
- כתובת אתר/URL (אופציונלי)
- כתובת תפריט/URL (אופציונלי)
- לוגו (העלאה/ברירת מחדל כארגז)
- צבעי ברנד (מניפת צבעים, HEX)
- אנשי קשר (רשימה עד 2: שם, טלפון, תפקיד)
- הערות פנימיות


**ניהול והרשאות:**
- רמות הרשאה: עובד / מנהל (מקום/משמרת)
- טבלת משתמשים (שם, טלפון, דוא"ל, תפקיד)
- הוספה/עריכת/מחיקת משתמש (ברמת הרשאה 1 בלבד)
- הקצאת סיסמת מנהל/משמרת לפעולות רגישות


### הגדרות כרטיסייה:
- מספר ניקובים מקסימלי/מזכה
- סוג הבונוס בהשלמת כרטיסייה
- תקופת פקיעה (חודשים או לצמיתות)
- הנחה על תשלום מראש (עם סטטוס בכרטיסייה)
- הגדרת מוצרים לניקוב
- אייקונים מנוקבים ולפני ניקוב
- צבע ברנד לטקסטים
- מצב ניקוב (אוטומטי/חצי אוטומטי)


**אייקונים:**
- אייקון לניקוב (לפני ניקוב) - בחירה מתוך מאגר או העלאה
- אייקון מנוקב (אחרי ניקוב) - בחירה מתוך מאגר או העלאה
- תמונת נושא בכניסה לכרטיסייה
- צבע ברנד לטקסטים ותפריטים


**הגדרות ניקוב:**
- ניקוב אוטומטי (צ'קבוקס) - ללא התערבות ידנית
- ניקוב חצי אוטומטי (צ'קבוקס) - פתיחת כרטיסייה לביצוע ידני


### הגדרות מערכת:
- **גיבוי ידני יזום למכשיר** (כפתור לחיצה)
- **גיבוי אוטומטי לסופרבייס** - גיבוי הכל כולל הדטה:
  - שדה להכנסת אינטרוול גיבוי 
  - הגבלה: לא יותר מפעמיים ביום
  - אפשרויות בחירה: כל שעה/כל 4 שעות/כל 6 שעות/כל 12 שעות
- **שחזור נתונים**
- **יבוא לקוחות**: 
  - הוראות לפורמט Excel/CSV לקליטת לקוחות קיימים
  - לפי שדות חובה
  - אפשרות לבחירת גיליון
  - הוראות פורמט מפורטות
- **יצוא לקוחות**: 
  - יצוא לפורמט Excel/CSV להורדת לקוחות קיימים
  - לפי השדות הקיימים
  - הוראות פורמט מפורטות


---


## לוג/תיעוד פעולות


לוג שמתעד את כל פעולות הלקוח של העסק ושל העסק עצמו:
- גיבויים ושחזורים
- שם משתמש של העסק
- עדכוני גרסה
- יבוא או יצוא של רשימת לקוחות
- פעולות לקוחות: פתיחת האפליקציה, זמן צפייה, יצירת קשר, קבלת הטבות, ניקובים, חידושי כרטיסייה, זכייה בהגרלה


**הערה:** הלוגים הקשורים לפעילות לקוחות יהיו זמינים לצפיה בממשק הלקוח בפריט תפריט "הפעילות שלי". הלוגים של בית העסק והמערכת לא זמינים ללקוחות העסק.


---


## ניהול תוכניות ותשלומים


### הצגת סוגי מסלולי התוכניות:
(עם אפשרות שינוי לממשק המפתח העתידי)


### רכישת חבילות:
אפשרות לרכוש חבילות של 1000 פושים בנפרד לפי מסלול התוכנית לאחר ניצול הפושים בחינם


### מעקב מכסות:
- מצב כמות שליחת הודעות פוש מול מכסת החבילה
- כפתור "רכוש חבילה"


---


## עזרה/צור קשר


### תשתית לחלונית שיחה עם סוכן AI:
(לרשום בטודו ליסט להשלים חלונית)


הסוכן יהיה מקושר ב-MCP לנתוני חיוב של הלקוח, לתנאי המסלולים, לבעיות נפוצות, להדרכה בשימוש באפליקציה לדשבורד של העסק ויוכל גם לייעץ וגם להפיק דוחות חיוב לפי דרישה.


### אבטחת הסוכן:
תשתית אבטחה לסוכן של סיסמה ווידוא טלפוני אם המשתמש מעוניין במידע שקשור לעסק שלו.


### איך הסוכן יכול לעזור:
הסבר מפורט על יכולות הסוכן


### יצירת קשר:
אימייל: yula@yuladigital.com


---


## שינויים נדרשים במסמך האפיון המקורי


### עדכונים שבוצעו:


1. **החלפת הפלטפורמה**:
   - במקום: "ממשק ניהול וובי רץ מצוין על נוטבוק/אייפד (ואפילו נייד)"
   - חדש: "ממשק ניהול ווב בטכנולוגיית React Web + TypeScript PWA לרספונסיביות מלאה"


2. **מבנה ארכיטקטוני מעודכן**:
   - הוספת פירוט על עיצוב רספונסיבי
   - הגדרת התנהגות לטאבלט לעומת מובייל
   - מפרט טכני מפורט


3. **מערכת הזדהות**:
   - החלפת שיטת הכניסה לבעלי עסקים
   - הוספת רמות הרשאה מפורטות
   - אבטחה מחמירה יותר


4. **הסרת הוראות WeWeb**:
   - מחיקת ההוראות ל-WeWeb בסוף המסמך
   - החלפה בהוראות פיתוח React Web


5. **הוספת PWA ו-Monorepo**:
   - פלטפורמת הפצה מתקדמת
   - סביבת פיתוח מאורגנת


---


## הערות נוספות


- המסמך הזה הוא המסמך האחיד והיחיד לשימוש
- כל שינוי יתועד עם תאריך ונימוק  
- יש לשמור על עקביות עם המסמכים הקיימים
- שמירה מלאה על הלוגיקה העסקית והפונקציונליות המקורית
- שמירה מלאה על שדות, טבלאות ופונקציות כפי שהוגדרו


---
*

---

## הערות TODO למפתח

### פרטים טכניים לביצוע:

1. **חיבור מסמך משפטי:**
   - לרשום בטודו ליסט - חיבור מסמך משפטי על תנאי ההתקשרות
   - מדיניות פרטיות מלאה של השירות

2. **העלאת תמונות ואייקונים:**
   - TODO למימוש מדויק של העלאת תמונות/אייקונים
   - TODO לבדיקת אפשרות הוספת תמונה לפלטפורמות נייטיב

3. **עיצובים וצבעים:**
   - TODO למימוש לקראת סיום - כל עיצוב/הגדרת צבעים
   - התאמת מלא ל-dark/bright mode
   - חיווי ברור על תקינות/שגיאות בכל יצירה/עריכה

4. **סוכן AI ותמיכה:**
   - הכנת תשתית לחלונית שיחה עם סוכן AI
   - השלמת חלונית עזרה והדרכה

5. **פורמט יבוא/יצוא:**
   - הוראות מפורטות לפורמט Excel/CSV
   - תבניות מוכנות להורדה

---
*

### ניהול גרסאות:
- **Semantic Versioning** - v1.2.3
- **Web PWA**: עדכונים מיידיים (מהיר)
- **תאימות לאחור** עם Supabase API


---


## סביבות פיתוח נפרדות ודשבורד מפתח


### צורך בשתי סביבות פיתוח נפרדות:

**1. סביבת פיתוח ממשק לקוחות (React Native):**
- **Development**: `yarn mobile:dev` - Metro bundler + Expo dev client
- **Staging**: TestFlight (iOS) / Firebase App Distribution (Android)
- **Production**: App Store / Google Play Store
- **מאפיינים**: read-only, ברקוד, הצגת כרטיסיות

**2. סביבת פיתוח ממשק בעלי עסקים (React Web PWA):**
- **Development**: `yarn web:dev` - Vite dev server
- **Staging**: Vercel/Netlify staging URL
- **Production**: PWA domain עם התקנה מהדפדפן
- **מאפיינים**: ניהול מלא, סטטיסטיקות, הגדרות


### הפקת גרסאות נפרדות:

**תהליך CI/CD דו-מסלולי:**
```
# ממשק לקוחות (Mobile)
on: push to mobile/*
  → Build React Native
  → Deploy to mobile staging/production
  → Generate APK/IPA files
  → Update app stores

# ממשק בעלי עסקים (Web)
on: push to web/*
  → Build React Web PWA
  → Deploy to web staging/production
  → Generate PWA manifest
  → Update service worker
```

**ניהול גרסאות מקבילות:**
- **Mobile App**: v1.2.3-mobile
- **Web Admin**: v1.2.3-web
- **Shared Packages**: v1.2.3-shared
- **Database Schema**: v1.2.3-db


### דשבורד מפתח - מערכת ניהול ופיקוח:

**מטרה:** פיקוח כולל על שני הממשקים, ביצועים, שגיאות ונתוני שימוש

**תכונות עיקריות:**

**1. לוגים מתאימים:**
- **Application Logs**: שגיאות, אזהרות, אירועים קריטיים
- **Performance Logs**: זמני טעינה, שימוש במטמון, בקשות API
- **Business Logs**: פעולות משתמשים, ניקובים, הגרלות, פושים
- **Security Logs**: נסיונות כניסה, הרשאות, פעולות חשודות

**2. מידע מבתי עסקים:**
- **סטטיסטיקות שימוש**: כמות לקוחות, ניקובים, פושים לכל עסק
- **ביצועים טכניים**: זמני תגובה, שגיאות, תקלות
- **נתוני חיוב**: מכסות, רכישות, סטטוס תשלומים
- **תמיכה טכנית**: פניות, בעיות נפוצות, פתרונות

**3. פונקציות ניהול:**
- **ניהול עסקים**: הפעלה/השבתה, שינוי מסלולים, איפוס נתונים
- **ניטור מערכת**: server health, database performance, API monitoring
- **ניהול גרסאות**: עדכונים מרחוק, rollback, A/B testing
- **ניתוח נתונים**: דוחות שימוש, מגמות, חיזויים


### שילוב דשבורד מפתח בסביבת הפיתוח:

**אפשרות 1: דשבורד נפרד (מומלצת):**
```
cards_project/
├── apps/
│   ├── mobile/              # React Native (לקוחות)
│   ├── web-admin/           # React Web (בעלי עסקים)
│   ├── web-developer/       # React Web (דשבורד מפתח)
│   └── landing/             # דף נחיתה
├── packages/
│   ├── developer-tools/     # כלי פיתוח ופיקוח
│   ├── monitoring/          # ניטור וlogs
│   └── analytics/           # ניתוח נתונים
```

**אפשרות 2: שילוב בממשק בעלי עסקים:**
- **גישה מוגבלת**: הרשאת super-admin בלבד
- **תת-תפריט מיוחד**: "ממשק מפתח" עם גלגל שיניים
- **אבטחה מוחמרת**: דו-שלבי + IP filtering + VPN


### טכנולוגיות דשבורד מפתח:

**Frontend:**
- **React Web**: ממשק משתמש אחיד עם שאר המערכת
- **Charts & Analytics**: Recharts, D3.js לגרפים ודוחות
- **Real-time Updates**: Socket.io לעדכונים בזמן אמת

**Backend & Monitoring:**
- **Logging**: Winston/Pino עם Elasticsearch/Loki
- **Monitoring**: Prometheus + Grafana
- **APM**: Application Performance Monitoring
- **Alerting**: מערכת התרעות אוטומטית

**Database:**
- **Analytics DB**: ClickHouse/TimescaleDB לנתוני זמן
- **Main DB**: Supabase (משותף)
- **Logs Storage**: ELK Stack או Loki


### אבטחה ובקרה:

**הרשאות דשבורד מפתח:**
- **Level 1**: צפייה בלוגים ונתונים כלליים
- **Level 2**: ניהול עסקים בודדים, תמיכה טכנית
- **Level 3**: ניהול מערכת מלא, עדכון גרסאות, הגדרות כלליות

**אבטחה:**
- **Multi-factor Authentication**: חובה לכל רמות הגישה
- **IP Whitelisting**: גישה ממקומות מוגדרים בלבד
- **Audit Trail**: תיעוד מלא של כל פעולות המפתחים
- **Data Masking**: הסתרת מידע רגיש בסביבת פיתוח


---